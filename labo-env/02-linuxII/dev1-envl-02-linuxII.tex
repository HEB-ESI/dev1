\documentclass[a4paper,11pt]{style-esi/td}
%\documentclass[a4paper,11pt,draft]{style-esi/td}

\usepackage{style-esi/licence}
\usepackage{style-esi/exercice}
\usepackage{style-esi/exemple}
\usepackage{style-esi/question}
\usepackage{style-esi/tutoriel}
\usepackage{style-esi/listing}
\usepackage{style-esi/images}
\usepackage{style-dev1/dev1}

\begin{document}

\seance{2}{GNU/Linux (partie II)}
\entete
\titre
\ccbysa{esi-dev1-list@he2b.be}
\lastedit

\bigskip
\tableofcontents

\vfill
\begin{infobox}
    Dans votre répertoire \samp{\textasciitilde/dev1}, 
	créez un répertoire \samp{td2}. 
    Il contiendra tous les fichiers que vous allez créer aujourd'hui. 
\end{infobox}
\vfill

\newpage

%====================
\section{Système de fichiers}
%=====================

	Pour l'instant vous êtes resté dans votre dossier personnel 
	mais le monde est plus vaste.
	Explorons le système de fichiers.

    %==================================
	\subsection{Racine du système de fichiers}
	%==================================

		Rappelez-vous que les fichiers sont organisés en hiérarchie :
		un dossier contient d'autres dossiers qui lui-même\dots

		On a vu que chaque utilisateur dispose d'un dossier personnel. 
		Où se trouve-il ? Dans un dossier appelé \samp{home}. 
		Et où se trouve ce dossier \samp{home} ? 
		Dans un dossier appelé \og{}\samp{/}\fg{} (la barre oblique). 
		Et où se trouve ce dossier \og{}\samp{/}\fg{} ? Nulle part ;) 
		C'est le dossier principal (la \emph{racine}).

		\begin{theorie}{La racine du système de fichiers}
			La \emph{racine} est le dossier principal, 
			tout en haut de la hiérarchie des dossiers.
		\end{theorie}

	%==================================
	\subsection{Chemin absolu et relatif}
	%==================================

		\exergue{Tout est relatif, et cela seul est absolu.}{Auguste Comte}
		
		\bigskip
		Régulièrement, il faut indiquer un endroit du système de fichiers 
		(par exemple pour y aller). 
		Désigner simplement le nom du dossier ne suffit pas.  
		Nous avons déjà abordé la notion de \emph{chemin}; Précisons.

		\begin{theorie}{Chemin absolu et relatif}
			\begin{description}
			\item[Chemin]
				Un \emph{chemin} est une suite de dossiers à traverser 
				pour arriver au dossier ou au fichier qui nous intéresse.
				On les sépare par \og{}\samp{/}\fg{}.

				Par exemple : \samp{home/g12345/dev1/td1/test}
				indique que dans le dossier \samp{home}
				il y a un dossier \samp{g12345}
				qui contient un dossier \samp{dev1} 
				qui contient un dossier \samp{td1} 
				qui contient un fichier (ou un dossier) \samp{test}.
			\item[Chemin absolu]
				Un chemin est \emph{absolu} 
				s'il commence à partir de la \emph{racine}.
				Il commence donc par \og{}\samp{/}\fg{}.
				Par exemple : \samp{/home/g12345/td1/test}
			\item[Chemin absolu]
				Dans le cas contraire il est \emph{relatif}.
				Il s'agit d'un chemin à suivre à partir du \emph{dossier courant}.
			\end{description}
		\end{theorie}

		\begin{alertbox}
			Un chemin \emph{absolu} désigne toujours le même endroit.
			Un chemin \emph{relatif} non ! \c ca dépend d'où on est,
			du dossier courant.
		\end{alertbox}

		\begin{Exercice}{pwd}
			Entrez la commande \kbd{pwd} (que fait-elle encore ?). 
			Comprenez-vous la notation qu'elle utilise pour la réponse ?
			Est-ce une chemin absolu ou relatif ?
		\end{Exercice}

		\begin{infobox}
			Rappel : dans une commande, un nom de fichier (ou de dossier)
			désigne toujours un fichier (ou un dossier) se trouvant
			dans le dossier courant
	
			Pour indiquer un \emph{fichier} (ou un dossier) 
			se trouvant \emph{ailleurs},
			il faut donner son \emph{chemin} (absolu ou relatif).
		\end{infobox}

		Par exemple : \kbd{ls /home/g12345}
		permet de visualiser le contenu de la home de \samp{g12345}
		(quel que soit l'endroit où on se trouve puisque c'est un chemin absolu).
		
		\begin{Exercice}{Utilisation d'un chemin}
			Supposons que vous êtes dans votre home 
			et que vous ne pouvez pas vous déplacer 
			(la commande \samp{cd} est interdite !).
			\begin{enumerate}
			\item 
				Affichez le contenu du fichier \samp{readme}
				(qui se trouve dans le dossier \samp{td1})
				en utilisant un chemin \emph{relatif}.
			\item 
				Faites la même chose 
				en utilisant un chemin \emph{absolu}.
			\item
				Créez une copie du fichier \samp{welcome} 
				dans le dossier \samp{dev1/td2}
				en utilisant des chemins absolus.
			\end{enumerate}
		\end{Exercice}

	%==================================
	\subsection{Raccourcis pour des chemins}
	%==================================

		\begin{theorie}{Raccourcis}
			Dans un chemin :
			\begin{itemize}
			\item \samp{\textasciitilde{}g12345} : désigne la home de l'utilisateur \samp{g12345} ;
			\item \samp{\textasciitilde{}} : désigne la home de l'utilisateur qui entre la commande ;
			\item \samp{..} : désigne le dossier parent du dossier courant ;
			\item \samp{.} : désigne le dossier courant.
			\end{itemize}
		\end{theorie}

		\begin{Exercice}{Se familiariser avec les raccourcis}
			Placez-vous dans votre dossier personnel.
			En utilisant les raccourcis 
			afin de trouver la solution la plus courte possible :
			\begin{enumerate}
			\item Affichez le contenu de votre dossier personnel
				en utilisant un chemin absolu.
			\item Affichez le contenu de la home de votre professeur
				en utilisant un chemin absolu.
			\item Refaites la même chose mais en utilisant un chemin relatif.
			\end{enumerate}
		\end{Exercice}

		\begin{Exercice}{Comprendre un chemin}
			Que désigne le chemin suivant :
			\samp{\textasciitilde{}mcd/../../home} ?
		\end{Exercice}

		\begin{Exercice}{Chemins absolus et relatifs}
			Parmi tous les chemins suivants, quels sont ceux qui sont 
			\emph{relatifs} ?			
			\begin{selectmany} 
			\item \verb@~/../g12345/td2@
			\item \verb@/home/g12345/../g54321/Hello.java@
			\item \verb@./tds/td2@
			\item \verb@tds/td2/Hello.java@
			\item \verb@~g12345/tds/td2@
			\end{selectmany} 
        \end{Exercice}

		\begin{Exercice}{Utilisation d'un chemin (2)}
			On voudrait créer une copie du fichier \samp{welcome}
			dans le dossier \samp{~/dev1/td2}.
			\begin{enumerate}
			\item 
				Quelle est la commande pour le faire en utilisant
				des chemins \emph{absolus} si le dossier courant
				est le répertoire personnel ?
				\textbox{2em}
			\item 
				Idem mais avec des chemins \emph{relatifs}.
				\textbox{2em}
			\item 
				Avec des chemins \emph{relatifs}
				si le répertoire courant est \verb|~/dev1/|.
				\textbox{2em}
			\item 
				Idem mais avec des chemins \emph{absolus}.
				\textbox{2em}
			\item 
				Avec des chemins \emph{relatifs}
				si le répertoire courant est \verb|~/dev1/td2/|.
				\textbox{2em}
			\item 
				Idem mais avec des chemins \emph{absolus}.
				\textbox{2em}
		\end{enumerate}
		\end{Exercice}

%====================
\section{Ligne de commandes}
%=====================

	Nous avons déjà vu quelques règles concernant la ligne de commande.
	Voyons quelques notions supplémentaires qui vont vous être utiles.

	%====================
	\subsection{Complétion de commande}
	%====================

		Parfois, vous ne vous rappelez plus exactement d'une commande.
		Le shell peut vous aider.  

		\begin{Experience}{La complétion de la commande} 
			Supposons que vous ne vous rappeliez plus très bien 
			de la commande qui permet de modifier le mot de passe.
			Vous vous rappelez juste qu'elle commence par \verb|pas|.
			\begin{steps}
			\item 
				Tapez \kbd{pas} sans appuyer sur \samp{ENTER}.
			\item 
				Appuyez $2\times$ sur la touche \samp{TAB}.
				Le shell affiche la liste des commandes commençant ainsi.
			\item 
				Tapez sur \kbd{s} puis à nouveau $2\times$ sur la touche \samp{TAB}.
				Comme il n'y a plus qu'une seule possibilité, le shell complète la commande.
			\end{steps}  
		\end{Experience}		

		\begin{Exercice}{La complétion des noms de fichiers} 
			La touche de tabulation permet également de compléter un nom de fichier. 
			\begin{enumerate}
  			\item Copiez chez vous le fichier\par
	  			\verb@monfichieraunomtellementlongquilmeparaitpeuprobabledeletaper2xsanserreur@ 
	  			qui se trouve dans le dossier \verb@/eCours/dev1/envl/@.
			\item Affichez le contenu de ce fichier en évitant de retaper son nom.
			\end{enumerate}
		\end{Exercice}	

	%====================
	\subsection{Historique}
	%====================

		Il arrive souvent qu'on oublie une commande qu'on a déjà utilisée avant.
		Le shell retient un historique des commandes tapées par un utilisateur
		et il est possible de l'exploiter.
		
		\begin{theorie}{Historique}
			\begin{itemize}
			\item 
				Les flèches \emph{haut} et \emph{bas}
				permettent de se déplacer dans les commandes déjà entrées.
			\item 
				\kbd{history} affiche la liste (numérotée)
				des dernières commandes tapées.
			\item 
				\kbd{!n} réexécute la commande numéro \emph{n}.
			\item 
				\kbd{!mot} réexécute la commande la plus récente 
				\emph{commençant} par \emph{mot}.
			\item 
				\kbd{!?mot} réexécute la commande la plus récente 
				\emph{contenant} \emph{mot}.
			\item 
				\kbd{\^{}chaine1\^{}chaine2\^{}} réexécute la dernière commande
				en remplaçant \emph{chaine1} par \emph{chaine2}.
			\end{itemize}
		\end{theorie}

	%====================
	\subsection{Options}
	%=====================
	
		La plupart des commandes possèdent des \emph{options}.

		\begin{theorie}{Les options}
			Une \emph{option modifie le sens} d'une commande ;
			\begin{itemize}
			\item Elle commence par le signe \texttt{-} suivi d'une seule lettre ;
			\item ou encore par le double tiret \texttt{-{}-} suivi d'un nom d'option.
			\item Elle est placée n'importe où après le nom de la commande.   
			\end{itemize}
		\end{theorie}		

		\begin{Experience}{Expérimenter les options}		
			\vspace{-1em}
			\begin{steps}
			\item Tapez la commande \kbd{ls -l}. 
				Vous constatez que le résultat obtenu est beaucoup plus verbeux%
				\footnote{%
					Vous apprendrez dans un prochain TD 
					à comprendre ces informations supplémentaires.
				} 
				que celui obtenu sans l'option.
			\item Entrez la commande \kbd{cat -n welcome}. 
				L'option demande de numéroter les lignes 
			\item Essayez \kbd{cat -{}-number welcome},
				la version \textit{longue} équivalente à la précédente.
			\end{steps}
		\end{Experience}

%====================
\section{Fichiers cachés}
%=====================

	Nous avons vu que le shell retient les dernières commandes entrées.
	Où exactement est ce que c'est retenu ?
	Dans un fichier qui s'appelle \verb|.bash_history| dans votre \emph{home}.

	\begin{Experience}{Un fichier caché}
		Vérifions ce qu'on vient d'affirmer.
		\begin{steps}
		\item Entrez \kbd{cd} pour vous assurer d'être dans votre \emph{home}.
		\item Entrez \kbd{ls} pour en voir le contenu.
			\\Le fichier \verb|.bash_history| n'a pas l'air d'être présent !?
		\item Entrez \kbd{cat .bash\_{}history} pour quand même en afficher son contenu.
			\\Le shell vous affiche bien vos anciennes commandes sans afficher d'erreur !?
		\end{steps}
	\end{Experience}

	\medskip
	\begin{theorie}{Fichiers cachés}
		Un \emph{fichier caché} 
		est un fichier dont le nom commence par un point.
		\begin{itemize}
		\item Par défaut, il n'est pas montré par la commande \kbd{ls}.
		\item L'option \kbd{-a} demande de montrer les fichiers cachés.
		\end{itemize}
	\end{theorie}

	\begin{Experience}{Voir les fichiers cachés}
		Testons ce qu'on vient d'apprendre.
		\begin{steps}
		\item Entrez la commande \kbd{ls -a}.
			\\La commande affiche beaucoup plus de fichiers qu'avant,
			dont celui qui nous intéresse.
		\end{steps}
	\end{Experience}

%====================
\section{Documentation}
%=====================

	%====================
	\subsection{Recherche d'informations}  
	%====================

		Non seulement, il y a beaucoup de commandes à connaitre mais, en plus, 
		chacune dispose d'une multitude d'options. 
		Impossible de tout retenir ! Comment faire ?   

		\begin{theorie}{Information}
			\begin{itemize}
			\item 
				\kbd{nomCommande -{}-help}
				affiche une aide succincte sur la commande.
			\item 
				\kbd{man nomCommande} affiche une documentation plus complète.
				(\textit{q} pour quitter).
			\end{itemize}
		\end{theorie}

		Si vous ne connaissez pas le nom de la commande, vous pouvez
                \begin{itemize}
                \item utiliser \kbd{man 1 intro} pour lire une introduction aux commandes les plus simples ;
                \item consulter les ressources que l'on met à votre disposition sur poESI ;
                \item utiliser \kbd{apropos} suivi d'une expression à chercher ;
                \item utiliser votre moteur de recherche favori, pour chercher par exemple une \textit{\name{GNU/Linux} Cheat Sheet}.
                \end{itemize}
		\begin{Exercice}{Trouver la bonne option} 
			La commande \kbd{ls -l} 
			affiche le contenu du dossier en format \textit{long}.
			La 5\ieme{} colonne donne la taille du fichier (en octets).
			Lorsque les nombres sont grands, ce n'est pas très lisible. 
			Trouvez l'option qui permet d'afficher cette taille sous un format plus lisible.  
			
			\begin{alertbox} 
				De grâce, \emph{cherchez} la réponse, 
				ne la \emph{demandez pas} à votre voisin. 
				Le but de cet exercice n'est pas de connaitre l'option 
				(elle n'est pas si utile que \c ca) 
				mais d'apprendre à trouver soi-même l'information.  
			\end{alertbox}
		\end{Exercice}

	%====================
	\subsection{Parcours d'un long document}  
	%====================

		Lorsque vous avez demandé de l'aide, 
		la commande \samp{man} vous a affiché 
		le contenu d'un fichier contenant cette aide.
		Comme il est long, il ne l'a pas affiché comme le ferait un \samp{cat}
		mais au travers d'une commande 
		qui permet d'afficher \emph{page par page} un document.

		\begin{theorie}{less}
			\kbd{less nomDeFichier} 
			permet de \emph{consulter} le fichier en question \emph{page par page}.
			\begin{itemize}
			\item
				Ce n'est pas un éditeur ; vous ne pouvez \emph{pas modifier} le document.
			\item 
				Les flèches et les touches \samp{PGUP} et \samp{PGDN}
				permettent de se déplacer dans le document.
			\item 
				Appuyez sur \samp{q} pour terminer la consultation. 
			\item 
				\samp{/mot} cherche le mot donné dans le document.
			\item 
				\samp{n} montre l'occurrence suivante du mot recherché.
			\end{itemize}
		\end{theorie}

		Toutes ces facilités peuvent être utilisées lorsque vous parcourez
		une aide%
		\footnote{%
			Il en existe bien plus ! \kbd{man less} si vous êtes intéressé.
		}.

		\begin{Exercice}{Trouver la bonne option (II)}
			Quelqu'un m'a dit que la commande \samp{pouvait}
			afficher à coté de chaque fichier la date de sa dernière modification
			mais je ne me rappelle plus de l'option. 
			Pouvez-vous m'aider ?
			Aide: en anglais, on dit \og{}last modification\fg{}.
		\end{Exercice}

%===================
\section{Conclusion}
%====================

	\begin{theorie}{Notions importantes de ce TD}
		Voici les notions importantes que vous devez avoir assimilées à la fin de ce TD.
		\begin{itemize}
		\item 
			Comprendre la notion de chemin absolu et relatif.
			Savoir les utiliser dans les commandes.
		\item 
			Connaitre la signification dans un chemin de : 
			\og{}\samp{\textasciitilde}\fg{},
			\og{}\samp{.}\fg{} et \og{}\samp{..}\fg{}.
		\item 
			Pouvoir demander plus d'informations sur une commande, ses options.
			Comprendre les informations fournies.
		\item 
			Comprendre la notion de fichier caché.
		\item 
			Savoir utiliser à bon escient les facilités du shell
			pour simplifier l'entrée des commandes (historique, flèches\dots)
		% \item 
		% 	La notion de propriétaire de fichier et la notion de groupe.
		% \item 
		% 	Pourvoir interpréter le résultat de la commande \kbd{ls -l}. 
		% \item 
		% 	Comprendre que les permissions sont données à 3 catégories de personnes
		% 	et comprendre ce que ces catégories signifient.
		% \item 
		% 	Comprendre les 3 sortes de permissions pour un fichier et pour un dossier.
		% \item 
		% 	Pourvoir modifier le groupe et les permissions
		% 	(avec des nombres et avec des lettres).
		\end{itemize}
	\end{theorie}

	\bigskip
	\begin{infotbox}{Félicitations !} 
		Vous êtes arrivé au bout de ce TD.
		Avant de quitter le laboratoire, n'oubliez pas de quitter proprement 
		la connexion avec \samp{linux1} (\kbd{exit}) 
		et d'éteindre l'ordinateur (ou au moins de vous déloguer).

		À la semaine prochaine et soyez à l'heure !
	\end{infotbox}

\end{document}

	
