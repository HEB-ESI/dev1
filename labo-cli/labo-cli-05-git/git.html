<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-09-11 Tue 10:08 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>git - the stupid content tracker</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Nicolas Richard [[mailto:nrichard@he2b.be][nrichard@he2b.be]]nrichard@he2b.be" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="styles/tdstyle.css" title="Style">
<script src="styles/jquery.min.js"></script>
<script src="styles/tdstyle.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">git - the stupid content tracker</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd9d0535">1. Contexte</a>
<ul>
<li><a href="#orge351b37">1.1. But</a></li>
<li><a href="#org1d8a347">1.2. Pré-requis</a></li>
<li><a href="#org0d87edf">1.3. Savoirs terminaux</a></li>
<li><a href="#org5967266">1.4. Fonctionnement du document</a></li>
</ul>
</li>
<li><a href="#orge0b62d2">2. Contenu</a>
<ul>
<li><a href="#org8a49df8">2.1. Introduction</a></li>
<li><a href="#org0ba72dd">2.2. Création d'un dépôt Git et de commits</a></li>
<li><a href="#org2453ea2">2.3. Affichage de l'historique et des commits</a></li>
<li><a href="#org64eeda4">2.4. Partage et collaboration : ajout de <i>remotes</i></a></li>
</ul>
</li>
<li><a href="#orgb6a9a0c">3. Pour aller plus loin&#x2026;</a>
<ul>
<li><a href="#orgcefb69a">3.1. Les branches</a></li>
<li><a href="#org38fd6d4">3.2. Lecture de l'historique (variante arborescente)</a></li>
<li><a href="#org824774d">3.3. diff et merge</a></li>
<li><a href="#orga427116">3.4. Lecture de l'historique (variante DAG)</a></li>
<li><a href="#orge6a0974">3.5. Gestion des conflits de fusion</a></li>
<li><a href="#orgbd33a1d">3.6. git et NetBeans</a></li>
</ul>
</li>
<li><a href="#org7d4c8c4">4. Annexe</a>
<ul>
<li><a href="#org3e219ec">4.1. Notion de branche, version abstraite</a></li>
<li><a href="#org1becd75">4.2. Anatomie d'un commit</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-orgd9d0535" class="outline-2">
<h2 id="orgd9d0535"><span class="section-number-2">1</span> Contexte</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orge351b37" class="outline-3">
<h3 id="orge351b37"><span class="section-number-3">1.1</span> But</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Le but du TD est d'apprendre le maniement basique de Git.
</p>

<p>
Git est un logiciel de gestion de versions ("revision control" ou
"version control"). Ce type de logiciels, et git en particulier, est
utilisé par de nombreux développeurs, tant en solitaire qu'en équipes,
notamment pour :
</p>

<ul class="org-ul">
<li>revenir et comparer différentes versions de leur code ou tout
document stocké comme un texte,</li>
<li>comprendre l'apparition de bugs éventuels</li>
<li>travailler en équipe</li>
</ul>

<p>
Au travers de ce TD nous vous montrerons comment Git aide à réaliser ces
objectifs.
</p>
</div>
</div>

<div id="outline-container-org1d8a347" class="outline-3">
<h3 id="org1d8a347"><span class="section-number-3">1.2</span> Pré-requis</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Les pré-requis sont l'utilisation basique :
</p>

<ul class="org-ul">
<li>de la ligne de commande sur Git Bash et linux1

<ul class="org-ul">
<li>éditer des fichiers</li>
<li>lancer des commandes</li>
<li>copier-coller depuis Windows vers linux1,</li>
</ul></li>

<li>de Netbeans

<ul class="org-ul">
<li>créer un projet Java</li>
</ul></li>

<li>du langage Java

<ul class="org-ul">
<li>écriture sur la sortie standard</li>
</ul></li>
</ul>

<p>
En particulier, aucune connaissance (pratique ou théorique) de Git n'est requise pour ce TD.
</p>
</div>
</div>

<div id="outline-container-org0d87edf" class="outline-3">
<h3 id="org0d87edf"><span class="section-number-3">1.3</span> Savoirs terminaux</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Voici les commandes que vous connaitrez à la fin de ce TD. Revenez-y en
fin de TD pour vérifier que vous comprenez chacune d'elle.
</p>

<pre class="example">
git init
git status
git add &lt;file&gt;...
git commit -m &lt;message&gt;
git log [--all] [--graph] [--oneline]
git show &lt;commit&gt;
git remote add &lt;name&gt; &lt;url&gt;
git remote -v
git remote update
</pre>


<p>
Les commandes suivantes sont
</p>
<pre class="example">
git diff
git diff &lt;commit1&gt; &lt;commit2&gt;
git merge &lt;branch&gt;
gitk
git branch [-a]
</pre>

<p>
Nous décrirons également le fichier <code>.gitignore</code>.
</p>
</div>
</div>

<div id="outline-container-org5967266" class="outline-3">
<h3 id="org5967266"><span class="section-number-3">1.4</span> Fonctionnement du document</h3>
<div class="outline-text-3" id="text-1-4">
<div class="tdaction">
<p>
Lisez les explications ci-dessous.
</p>

</div>

<div class="tdimportant">
<p>
Le document est conçu pour une lecture à deux niveaux :
</p>

<ol class="org-ol">
<li>En première lecture, vous pouvez vous concentrer sur différentes
actions à réaliser indiquée par le marquage "Action" sur fond rouge (voir ci-dessus). Ces actions
consistent généralement en commandes à recopier, adapter et lancer.</li>

<li>Lorsque vous voulez un complément d'information, lisez le texte
autour. Ce dernier fournira peut-être des réponses à des questions
que vous vous posez (généralement "Pourquoi ?").</li>
</ol>

<p>
Certaines de vos questions ne trouveront pas de réponse dans le texte. À
vous de les poser à vos condisciples et à vos enseignants.
</p>

</div>

<div class="tdastuce">
<p>
Soyez curieux ! Quelques pistes de réflexions, pour aller plus loin, sont parfois
suggérées par le marquage "Astuce", mais n'hésitez pas à vous lancer en
dehors des sentiers.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-orge0b62d2" class="outline-2">
<h2 id="orge0b62d2"><span class="section-number-2">2</span> Contenu</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org8a49df8" class="outline-3">
<h3 id="org8a49df8"><span class="section-number-3">2.1</span> Introduction</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org27ea087" class="outline-4">
<h4 id="org27ea087"><span class="section-number-4">2.1.1</span> Notion de contrôle de version</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
Si vous avez déjà écrit un document un peu long, vous vous êtes sans
doute déjà trouvé dans la situation où, après une grosse modification,
vous changez d'avis et décidez que la version précédente était
meilleure.
</p>

<p>
La façon la plus courante de s'en sortir est simplement de faire des
copies de votre travail avant (ou après) chaque modification importante.
Si vous écrivez un fichier <code>monTravail.txt</code> et que tout va bien, les
versions se succèdent simplement et ça doit donner ceci :
</p>

<pre class="example">
monTravail-version-du-3-juin.txt
monTravail-version-du-12-juin.txt
monTravail-version-du-13-juin.txt
monTravail.txt &lt;= Ceci est la version finale.
</pre>


<div class="figure">
<p><img src="./img/montravailLineaire.png" alt="montravailLineaire.png" />
</p>
</div>

<p>
Cela fonctionne assez bien mais nous verrons que même dans ce cas
simple, Git peut nous aider.
</p>

<p>
Cependant, en pratique, il est plus probable que vous obteniez des
fichiers un peu comme ceci (dans l'ordre chronologique) :
</p>

<pre class="example">
monTravail-version-du-3-juin.txt
monTravail-version-du-12-juin.txt
monTravail-version-finale.txt
monTravail-version-finale-avec-remerciements.txt
monTravail-version-finale-corrigée.txt
monTravail-version-finale-corrigée-avec-remerciements.txt
monTravail-version-vraiment-finale.txt
monTravail.txt &lt;= Hm, à quoi ça correspond déjà ?
</pre>

<p>
Ceci illustre un point : le processus de création n'est pas toujours
linéaire, même quand on travaille tout seul. Essayez de représenter les
liens logiques entre les différentes versions.
</p>

<p>
Voici une telle représentation :
</p>


<div class="figure">
<p><img src="./img/montravailNonLineaire.png" alt="montravailNonLineaire.png" />
</p>
</div>

<p>
En première approche, le travail avec Git ressemblera au travail sans
Git :
</p>

<ol class="org-ol">
<li>modification d'un document</li>
<li>sauvegarde dans Git</li>
<li>retour à l'étape 1 (sauf si le document est fini)</li>
<li>fini !</li>
</ol>

<p>
À ce stade les aspects importants de Git sont notamment qu'il :
</p>

<ul class="org-ul">
<li>va gérer pour vous les liens logiques entre les versions,</li>
<li>vous propose des outils pour comparer des versions et revenir en
arrière.</li>
</ul>

<p>
Par la suite, nous introduirons le travail collaboratif avec Git :
</p>

<ol class="org-ol">
<li>modification du document</li>
<li>sauvegarde dans Git</li>
<li>récupération du travail des collaborateurs et comparaison puis fusion
avec votre version</li>
<li>retour à l'étape 1 (sauf si le document est fini)</li>
<li>fini !</li>
</ol>

<p>
À ce stade, un nouvel aspect de Git sera important :
</p>

<ul class="org-ul">
<li>Il vous propose des outils pour fusionner des versions différentes</li>
</ul>
</div>
</div>

<div id="outline-container-org6e06236" class="outline-4">
<h4 id="org6e06236"><span class="section-number-4">2.1.2</span> Environnement de travail</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
Dans l'école, Git est déjà installé, tant sur les machines Windows que
sur le serveur <code>linux1</code>.
</p>

<div class="tdaction">
<p>
Lancez Git Bash via le menu Windows. Pour le trouver, ouvrez le
menu et tapez <code>Bash</code>. <code>Git Bash</code> devrait être le premier résultat.
Confirmez par la touchée Entrée.
</p>

</div>

<p>
Par ailleurs la conception de <code>Git</code> est telle que nous allons travailler
<i>dans un répertoire dédié</i> à notre projet. Cela peut vous sembler
étrange si vous pensez à l'exemple <code>monTravail.txt</code> (dans lequel il n'y
a finalement qu'un seul document en plusieurs versions) mais d'un autre
côté, un projet de programmation va généralement rassembler de nombreux
fichiers qu'il est naturel de mettre dans un répertoire dédié.
</p>

<div class="tdaction">
<p>
Créez et aller dans le répertoire <code>~/dev1/td-git/ex1/</code>.
</p>

</div>

<div class="tdreponse">
<p>
<code>mkdir -p ~/dev1/td-git/ex1</code> puis <code>cd ~/dev1/td-git/ex1</code>
</p>

</div>

<div class="tdastuce">
<p>
Si vous entrez d'abord <code>mkdir -p ~/dev1/td-git/ex1</code>, vous pouvez
obtenir la seconde commande en tapant <code>cd</code> suivi de <code>Alt+.</code>
(c'est-à-dire garder la touche Alt enfoncée taper le caractère <code>.</code>).
Cette dernière combinaison insère le dernier argument de la dernière
commande de l'historique. Une utilisation itérée permet de remonter dans
l'historique des commandes.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-org0ba72dd" class="outline-3">
<h3 id="org0ba72dd"><span class="section-number-3">2.2</span> Création d'un dépôt Git et de commits</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-orge1d02ec" class="outline-4">
<h4 id="orge1d02ec"><span class="section-number-4">2.2.1</span> Initialisation : git init</h4>
<div class="outline-text-4" id="text-2-2-1">
<div class="tdaction">
<p>
Initialisez un "dépôt Git" dans le répertoire de travail avec
<code>git init</code>. Voyez-vous ce qui a changé dans le répertoire courant ?
</p>

</div>

<p>
Hint: Si vous ne voyez pas, pensez aux fichiers cachés.
</p>

<div class="tdreponse">
<p>
Un répertoire <code>.git</code> est apparu (voir <code>ls -a</code>).
</p>

</div>

<p>
Le répertoire <code>.git</code> est le dépôt Git proprement dit. C'est lui qui
contiendra les différentes sauvegardes (nous dirons "commit"). Le
répertoire courant, quant à lui, est appelé "répertoire de travail".
</p>

<div class="tdastuce">
<p>
Pour voir tous les fichiers (y compris dans les
sous-répertoires) du répertoire courant, utilisez :
</p>
<pre class="example">
find . -type f
</pre>
<p>
Essayez aussi <code>find .</code> tout seul pour voir la différence.
</p>

</div>
</div>
</div>

<div id="outline-container-org0348237" class="outline-4">
<h4 id="org0348237"><span class="section-number-4">2.2.2</span> Intermède : créer un projet</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
Utiliser Git sans projet à construire, c'est un peu comme braquer une
caméra de surveillance sur un mur.
</p>

<p>
Nous allons donc développer un projet. Il ne sera pas très ambitieux car
le but est d'apprendre Git en moins de 2 heures, mais c'est mieux que
rien.
</p>

<div class="tdastuce">
<p>
Si vous avez un projet Java en tête, sentez-vous libre de
remplacer le projet HelloWorld ci-dessous par votre propre projet.
Pensez seulement à adapter les instructions et demandez de l'aide au
besoin !
</p>

</div>

<div class="tdaction">
<p>
Lancez NetBeans et créez un projet de type Java Application dans
le répertoire <code>Z:\dev1\td-git\</code>. Nommez le projet <code>HelloWorld</code> puis
cliquez "Finish" mais ne faites rien de plus (ne compilez pas tout de
suite).
</p>

</div>

<p>
Les prochaines étapes consisteront en l'élaboration de notre projet. À
chaque étape, nous allons sauver l'état du répertoire, comme une
sauvegarde du travail.
</p>
</div>
</div>

<div id="outline-container-org687b784" class="outline-4">
<h4 id="org687b784"><span class="section-number-4">2.2.3</span> Sélection des fichiers : git add</h4>
<div class="outline-text-4" id="text-2-2-3">
<div class="tdaction">
<p>
Revenez à Git Bash, et allez dans le répertoire de votre projet
<code>HelloWorld</code>. Inspectez le contenu de votre répertoire, puis créez un
dépôt Git dans ce répertoire.
</p>

</div>
<div class="tdreponse">
<pre class="example">
cd ~/dev1/td-git/HelloWorld
git init
</pre>

</div>

<p>
Netbeans crée de nombreux fichiers dans le répertoire du projet, y
compris dans des sous-répertoires. Nous n'allons pas détailler
maintenant le contenu de ces fichiers, mais simplement accepter qu'ils
sont là.
</p>

<div class="tdastuce">
<p>
Si vous êtes curieux, vous pouvez regarder précisément quels
fichiers ont été créés par NetBeans (rappel: <code>find . -type f</code>).
</p>

</div>

<div class="tdaction">
<p>
Pour voir ce que Git "comprend" de votre répertoire, entrez :
</p>
<pre class="example">
git status
</pre>

</div>


<p>
Cette commande ne modifie rien, mais montre l'état des choses. Nous
apprendrons à comprendre ce qu'elle dit, mais pour l'heure concentrons
nous sur:
</p>

<pre class="example">
Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)

    build.xml
    manifest.mf
    nbproject/
    src/

nothing added to commit but untracked files present (use "git add" to track)
</pre>

<p>
Git nous explique qu'il y a bien un dépôt à cet endroit (dans le cas contraire Git
afficherait une erreur), mais qu'aucun fichier n'est suivi ("tracked").
En fait Git s'attend à ce qu'on lui dise précisément les
fichiers à enregistrer, et il n'y en a pour l'instant aucun.
</p>

<div class="tdaction">
<p>
Commençons par indiquer que nous voulons sauvegarder tous les
fichiers du répertoire <code>src</code> :
</p>

<pre class="example">
git add src
git status
</pre>

</div>

<p>
Vous constatez une différence. Notez que Git a été chercher le fichier
<code>.java</code> dans un sous-répertoire.
</p>

<div class="tdaction">
<p>
Changeons d'avis, et indiquons maintenant que nous voulons en fait sauvegarder tous
les fichiers du répertoire courant :
</p>

<pre class="example">
git add .
</pre>

</div>

<p>
Pensez à lancer <code>git status</code> pour voir ce que Git a compris.
</p>

<p>
Notez toutefois que <code>git add</code> n'a pas encore réalisé la sauvegarde !
C'est une déclaration d'intention. Nous sommes prêt à lancer notre
premier sauvegarde. Git appelle cela un commit. Nous parlerons donc de
"faire un commit" ou de "committer".
</p>

<div class="tdastuce">
<p>
Allez voir ce que "commit" veut dire dans un dictionnaire
anglais, et voyez quel sens s'approche le plus de ce que nous faisons.
</p>

</div>

<div class="tdreponse">
<p>
Par exemple dans le Oxford Learner's<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>
on trouve
</p>

<blockquote>
<p>
commit something to memory : to learn something well enough to remember it exactly
</p>
</blockquote>

</div>
</div>
</div>

<div id="outline-container-orgabd1135" class="outline-4">
<h4 id="orgabd1135"><span class="section-number-4">2.2.4</span> Sauvegarde d'une version : git commit</h4>
<div class="outline-text-4" id="text-2-2-4">
<p>
Il est (presque) obligatoire, avec Git, de donner une description à nos
commits.
</p>

<p>
Notre projet en est au stade où Netbeans a généré des fichiers, sans que
rien d'autre n'ait été fait. Nous pouvons donc décrire l'état du projet
par :
</p>

<pre class="example">
HelloWorld: projet créé avec Netbeans
</pre>

<div class="tdaction">
<p>
Nous allons maintenant "committer" (c'est-à-dire sauvegarder) :
</p>
<pre class="example">
git commit -m "HelloWorld: projet créé avec Netbeans"
</pre>
<p>
N.B.: N'oubliez pas les guillemets.
</p>

</div>

<div class="tdastuce">
<p>
On peut omettre l'option <code>-m</code> et le message correspondant. Dans ce cas Git lance l'éditeur configuré (variable d'environnement <code>EDITOR</code>).
</p>

</div>


<div class="tdaction">
<p>
Lisez bien ce que Git vous répond et faites ce qui vous est
suggéré (indiquez <i>votre</i> adresse email et <i>votre</i> nom).
</p>

<pre class="example">
git config --global user.email "xxx@student.he2b.be"
git config --global user.name "Votre Nom"
</pre>

<p>
et:
</p>

<pre class="example">
git commit --amend --reset-author --no-edit
</pre>

</div>


<div class="tdaction">
<p>
Vérifiez que Git a bien sauvé votre projet avec <code>git status</code>.
</p>

</div>

<p>
La réponse devrait être:
</p>
<pre class="example">
On branch master
nothing to commit, working directory clean
</pre>
</div>
</div>

<div id="outline-container-org3a6f64b" class="outline-4">
<h4 id="org3a6f64b"><span class="section-number-4">2.2.5</span> Laisser des fichiers de côté : <code>.gitignore</code></h4>
<div class="outline-text-4" id="text-2-2-5">
<p>
Il arrive d'avoir des fichiers que nous ne voulons pas suivre avec Git. (Il
s'agit souvent de fichiers générés automatiquement, par exemple au moment de la
phase de compilation.) Voyons comment ignorer de tels fichiers.
</p>

<div class="tdaction">
<p>
Avant chacune des étapes suivantes, utilisez <code>ls -A</code> et
<code>git status</code> pour voir l'état de votre répertoire de travail et de votre
dépôt Git.
</p>

<ol class="org-ol">
<li>Lancez: <code>touch qsdf</code></li>
<li>Indiquez à git d'ignorer <code>qsdf</code> avec: <code>echo qsdf &gt; .gitignore</code></li>
<li>Nettoyez tout cela avec <code>rm qsdf .gitignore</code>.</li>
</ol>

</div>

<p>
Qu'avez vous constaté ?
</p>

<div class="tdreponse">
<ol class="org-ol">
<li>Après la première étape, <code>qsdf</code> est apparu.</li>
<li>À la seconde, <code>qsdf</code> a été ignoré par Git (mais toujours présent), mais
<code>.gitignore</code> est apparu.</li>
<li>À la troisième étape, <code>qsdf</code> et <code>.gitignore</code> ont disparu.</li>
</ol>

</div>

<div class="tdastuce">
<p>
Cherchez ce que fait <code>touch</code> sur le Web.
</p>

</div>

<div class="tdastuce">
<p>
Le sens du symbole <code>&gt;</code> vous sera expliqué dans un TD ultérieur
(c'est une redirection)
</p>

</div>

<p>
Nous utiliserons ce fichier <code>.gitignore</code> pour éviter que certains types
de fichiers apparaissent dans <code>git status</code> et fassent partie du commit.
</p>

<p>
Par exemple les fichiers <code>.class</code> seront ignorés de la sorte : ils sont
re-générés à chaque compilation, ils ne sont donc pas nécessaires pour
notre projet. En fait nous allons ignorer tout ce qui se trouvera dans
le répertoire <code>build</code>.
</p>

<div class="tdaction">
<ol class="org-ol">
<li>Ignorez le répertoire <code>build/</code> (de la même manière que nous avions
ignoré <code>qsdf</code>).</li>
<li>Incluez <code>.gitignore</code> dans un commit dont le message est ".gitignore:
ignore build/ directory"</li>
</ol>

</div>


<div class="tdreponse">
<pre class="example">
echo build/ &gt; .gitignore
git add .gitignore
git commit -m "Ignore le répertoire 'build'"
</pre>

</div>
</div>
</div>

<div id="outline-container-org4a6871f" class="outline-4">
<h4 id="org4a6871f"><span class="section-number-4">2.2.6</span> Intermède : avancer dans le projet</h4>
<div class="outline-text-4" id="text-2-2-6">
<p>
Il est temps d'avancer dans votre projet en suivant les étapes suivantes:
</p>

<ol class="org-ol">
<li>Modifier quelque chose (par exemple sous Netbeans, ou tout autre
éditeur)</li>
<li>Ajouter les fichiers modifiés avec <code>git add</code> (utilisez <code>git status</code>
pour voir ce qui est modifié).</li>
<li>Committer.</li>
<li>Retour à l'étape 1 pour continuer à avancer.</li>
</ol>

<p>
Pour <code>HelloWorld</code> nous vous proposons les quelques étapes simples
suivantes.
</p>

<p>
Notez qu'il est possible que <code>.gitignore</code> soit encore modifié
automatiquement par Netbeans. Vous pouvez committer ces changements.
</p>
</div>

<ol class="org-ol">
<li><a id="orgd68cfb6"></a>Faites afficher "Hello, World !" à votre programme java.<br />
<div class="outline-text-5" id="text-2-2-6-1">
<div class="tdaction">
<ol class="org-ol">
<li>Modifiez votre code sous Netbeans (et testez avec F6) pour que votre
application affiche "Hello, World !" sur la sortie standard.</li>
<li>Retournez dans Git Bash, et utilisez <code>git status</code> pour constater que
votre fichier .java a été modifié</li>
<li>Créez un commit incluant ce fichier <code>.java</code>.</li>
</ol>

</div>

<div class="tdastuce">
<p>
Dans Netbeans, tapez <code>sout</code> suivi d'un appui sur la touche TAB
pour insérer automatiquement de quoi écrire sur la sortie standard.
</p>

</div>
</div>
</li>

<li><a id="org31b91d6"></a>La suite du projet<br />
<div class="outline-text-5" id="text-2-2-6-2">
<p>
Nous développerons notre projet plus tard. Passons à autre chose.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org1b22bba" class="outline-4">
<h4 id="org1b22bba"><span class="section-number-4">2.2.7</span> Une explication sur la notion de commit</h4>
<div class="outline-text-4" id="text-2-2-7">
<p>
Un commit est un enregistrement de l'état de votre répertoire de travail
à un moment donné.
</p>

<p>
Dans un commit, les informations suivantes sont enregistrées :
</p>

<ol class="org-ol">
<li>L'état du répertoire de travail</li>
<li>L'auteur du commit</li>
<li>Le nom du commit qui précède (appelé aussi "commit parent")</li>
</ol>

<p>
Comment Git sait-il, au moment de créer un nouveau, quel est le commit qui précède ? La réponse est
assez simple : il y a un concept de "commit courant" et, au moment de créer
un nouveau commit, Git fait notamment deux choses:
</p>

<ul class="org-ul">
<li>le "commit courant" est désigné comme étant le "parent" du nouveau
commit, et</li>
<li>le nouveau commit devient le nouveau "commit courant".</li>
</ul>

<div class="tdastuce">
<p>
Pour en savoir plus, vous pourrez aller voir l'annexe
<a href="#org1becd75">Anatomie d'un commit</a>.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-org2453ea2" class="outline-3">
<h3 id="org2453ea2"><span class="section-number-3">2.3</span> Affichage de l'historique et des commits</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-orga0090cc" class="outline-4">
<h4 id="orga0090cc"><span class="section-number-4">2.3.1</span> Affichage l'historique</h4>
<div class="outline-text-4" id="text-2-3-1">
<div class="tdaction">
<p>
Pour voir l'évolution de votre dépôt de son origine jusqu'à maintenant, tapez
</p>
<pre class="example">
git log
</pre>

</div>

<p>
Vous devriez y retrouver tous vos commits avec leur description. Le plus
récent (= le commit courant) est en haut.
</p>

<p>
Ici, vous avez une vue d'ensemble de l'histoire de votre dépôt. Chaque
commit succède à son parent (à l'exception du premier, tout en bas, qui
n'a pas de parent).
</p>
</div>
</div>

<div id="outline-container-org647a9ff" class="outline-4">
<h4 id="org647a9ff"><span class="section-number-4">2.3.2</span> Lecture d'un commit</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
Dans le log, notez que chaque commit commence par une ligne du type:
</p>

<pre class="example">
commit 9941d89f56fbbcd3c8fbe29570af23c89e1708c5
</pre>

<p>
Ce qui se trouve à côté du mot "commit" est le nom du commit, toujours constitué de 40 caractères (des chiffres hexadécimaux). Nous l'appelons le "hash" du
commit (en français nous dirons parfois "haché").
</p>

<div class="tdastuce">
<p>
Ce hash est produit par une fonction "de hachage" appelée SHA-1.
Vous reverrez encore SHA-1 et d'autres fonctions de hachage en d'autres
occasions.
</p>

</div>

<p>
Pour désigner un commit, on peut généralement se contenter des 7
premiers caractères de son hash.
</p>

<div class="tdaction">
<p>
Notez les 7 premiers caractères du dernier commit de votre
dépôt (dans l'exemple c'est <code>9941d89</code>), et utilisez-les comme suit:
</p>

<pre class="example">
git show 9941d89
</pre>

</div>

<div class="tdastuce">
<p>
Que se passe-t-il si vous mettez moins que 7 caractères ?
</p>

</div>

<p>
Le résultat devrait être similaire à ceci:
</p>

<pre class="example">
commit 9941d89f56fbbcd3c8fbe29570af23c89e1708c5
Author: Nicolas Richard &lt;youngfrog@members.fsf.org&gt;
Date:   Mon May 28 17:03:36 2018 +0200

    Hello, World !

diff --git a/src/helloworld/HelloWorld.java b/src/helloworld/HelloWorld.java
index c49e653..206c27d 100644
--- a/src/helloworld/HelloWorld.java
+++ b/src/helloworld/HelloWorld.java
@@ -15,7 +15,7 @@ public class HelloWorld {
      * @param args the command line arguments
      */
     public static void main(String[] args) {
-        // TODO code application logic here
+        System.out.println("Hello, World !");
     }

 }
</pre>

<p>
Les lignes entre <code>diff --git ...</code> et <code>@@ ...</code> peuvent rester
mystérieuses, mais le reste devrait vous sembler familier. Prenez deux
minutes pour comprendre.
</p>

<div class="tdreponse">
<p>
Les premières lignes indiquent le nom du commit, le nom de l'auteur
du commit, la date à laquelle le commit a été fait.
</p>

</div>

<p>
Les lignes suivantes forment la description (que vous avez fournie) du
commit.
</p>

<p>
Suivent quelques lignes mystérieuses (jusque <code>@@ ... @@ ...</code>) et enfin
le "diff" du commit, c'est-à-dire une liste des différences entre ce
commit et son parent.
</p>

<p>
Dans le diff, chaque ligne commence par un symbole <code>+</code>, <code>-</code>, ou ` `, qui
veulent dire que la ligne a été, respectivmeent, "ajoutée", "enlevée" ou
"non-modifiée".
</p>

<div class="tdastuce">
<p>
On peut produire un diff entre deux fichiers texte grâce à la
commande <code>diff -u fichier1 fichier2</code>, mais c'est généralement plus
coloré si on demande à Git : <code>git diff --no-index fichier1 fichier2</code>.
Les options <code>--word-diff</code> et <code>-w</code> (équivalent à <code>--ignore-all-space</code>) sont
intéressantes. <code>git help diff</code> vous en dira plus sur les options
disponibles.
</p>

</div>
</div>
</div>

<div id="outline-container-org7b79636" class="outline-4">
<h4 id="org7b79636"><span class="section-number-4">2.3.3</span> Un outil graphique : <code>gitk</code></h4>
<div class="outline-text-4" id="text-2-3-3">
<div class="tdaction">
<p>
Testez la commande <code>gitk</code> pour avoir une autre vue de votre
historique. Nous l'utiliserons encore plus tard.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-org64eeda4" class="outline-3">
<h3 id="org64eeda4"><span class="section-number-3">2.4</span> Partage et collaboration : ajout de <i>remotes</i></h3>
<div class="outline-text-3" id="text-2-4">
<p>
Nous l'avons dit : Git permet de travailler en équipe.
</p>

<p>
Dans un premier temps nous allons vous faire travailler en équipe&#x2026;
avec vous-même.
</p>

<p>
Supposons que vous avez développé un code à l'école et que vous voulez
le continuer chez vous. Comment feriez-vous pour récupérer votre code
d'une machine à une autre ?
</p>

<div class="tdreponse">
<p>
On peut utiliser une clef USB, un "cloud" (NextCloud, Google Drive,
etc.),&#x2026; ou Git, bien sûr.
</p>

</div>
</div>

<div id="outline-container-org6a9c6fe" class="outline-4">
<h4 id="org6a9c6fe"><span class="section-number-4">2.4.1</span> Les principes</h4>
<div class="outline-text-4" id="text-2-4-1">
</div>
<ol class="org-ol">
<li><a id="org56004bc"></a>Principe de collaboration<br />
<div class="outline-text-5" id="text-2-4-1-1">
<p>
Le principe que nous allons détailler est le suivant:
</p>

<ol class="org-ol">
<li>Vous travaillez actuellement sur une machine (Machine1)</li>
<li>Vous envoyez par le réseau votre travail sur une machine distante (un
"serveur") allumée en permanence (Machine1 =&gt; Gitlab)</li>
<li>Vous passez sur une autre machine, par exemple votre ordinateur
portable ou une autre machine dans l'école (Machine2)</li>
<li>Vous récupérez par le réseau votre travail sur la nouvelle machine à
partir du serveur. (Gitlab =&gt; Machine2).</li>
</ol>


<div class="figure">
<p><img src="./img/travail-equipe.png" alt="travail-equipe.png" />
</p>
</div>

<div class="tdastuce">
<p>
Il est possible de se passer d'un dépôt Gitlab au centre du
processus, et de faire communiquer directement les deux Machine{1,2},
cependant cela implique d'une part que les deux machines restent
allumées pendant le transfert, d'autre part cela force à créer des accès
d'une machine à l'autre. Petit exercice de mathématiques : si on a N
machines et qu'on veut qu'elles puissent communiquer deux à deux de
façon directe, combien de liens faut-il établir ? Autre question : si on
a N machines et qu'on veut qu'elles puissent communiquer deux à deux
<i>via un tiers jouant le rôle de serveur central</i>, combien de liens
faut-il établir ?
</p>

</div>

<div class="tdreponse">
<p>
N(N-1)/2 dans le premier cas, et N dans le second cas.
</p>

</div>
</div>
</li>

<li><a id="org917684b"></a>Principe technique<br />
<div class="outline-text-5" id="text-2-4-1-2">
<p>
Techniquement, chaque dépôt Git peut être considéré comme étant un
<i>recueil de commits</i>, ou un <i>magasin de commits</i>
</p>

<p>
Chaque personne participant au projet a son (ou ses) dépôt(s) mais, pour
Git, peu importe qui contrôle tel ou tel dépôt. Tous les dépôts sont
équivalents.
</p>

<p>
Dans un dépôt donné, pour y ajouter des commits, on a deux manières de
faire:
</p>

<ul class="org-ul">
<li>créer des commits, comme on l'a fait précédemment (avec
<code>git commit</code>), ou</li>
<li>récupérer des commits venus d'autres dépôts, ce que nous allons faire
ici.</li>
</ul>

<p>
Une fois les commits récupérés, on a toujours le loisir de les utiliser
ou de ne pas le faire ; de la même manière que nous pouvons aller
acheter des livres et ne jamais les lire.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org96eb152" class="outline-4">
<h4 id="org96eb152"><span class="section-number-4">2.4.2</span> Gitlab</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
Les étapes à suivre sont :
</p>

<ol class="org-ol">
<li>Créer un dépôt sur votre machine actuelle avec du contenu (ça, c'est
déjà fait).</li>
<li>Créer un dépôt sur Gitlab.</li>
<li>Envoyer le contenu du premier dans le second.</li>
<li>Changer de machine.</li>
<li>Créer un dépôt sur la nouvelle machine.</li>
<li>Récupérer le contenu du dépôt Gitlab dans ce dernier dépôt.</li>
</ol>

<p>
Une fois tout mis en place, le travail ressemblera à :
</p>

<ol class="org-ol">
<li>Travailler sur une machine et committer au fur et à mesure</li>
<li>Envoyer sur Gitlab</li>
<li>Aller sur une autre machine</li>
<li>Récupérer le travail depuis Gitlab</li>
<li>retour à 1.</li>
</ol>
</div>

<ol class="org-ol">
<li><a id="orga9f502b"></a>Connexion à Gitlab<br />
<div class="outline-text-5" id="text-2-4-2-1">
<div class="tdaction">
<p>
Avec votre navigateur (Firefox, Chrome, &#x2026;), connectez vous à
<a href="https://git.esi-bru.be/">Gitlab</a> en utilisant votre compte HE2B-ESI
(Google).
</p>

</div>


<div class="figure">
<p><img src="./img/gitlablogin.jpg" alt="gitlablogin.jpg" />
</p>
</div>

<p>
Vous le constatez, Gitlab se présente sous la forme d'un serveur Web.
Nous n'avons pas accès à la ligne de commande sur ce serveur, mais,
rassurez-vous, cela n'est pas tellement plus difficile !
</p>

<div class="tdaction">
<p>
Allez dans <a href="https://git.esi-bru.be/profile">vos paramètres
Gitlab</a> (cliquez sur l'icône en haut à droite puis Settings) et
choisissez la rubrique
<a href="https://git.esi-bru.be/profile/password/edit">Password</a> puis enfin <i>I
forgot my password</i>.
</p>

</div>

<p>
Vous allez recevoir un email (vérifiez votre répertoire Spam si vous ne
le recevez pas après quelques secondes). Avant de cliquer sur "Reset
password" dans cet email, déconnectez-vous de Gitlab !
</p>

<p>
En attendant cet email, vous pouvez poursuivre le labo&#x2026;
</p>
</div>
</li>

<li><a id="org69453bd"></a>Création du dépôt sur Gitlab<br />
<div class="outline-text-5" id="text-2-4-2-2">
<div class="tdaction">
<p>
Retournez sur la page principale de Gitlab (par exemple par un
clic sur le logo qui se trouve en haut à gauche) et utilisez le bouton
vert "New project" sur la droite.
</p>

</div>


<div class="figure">
<p><img src="./img/gitlab-NewProject.jpg" alt="gitlab-NewProject.jpg" />
</p>
</div>

<div class="tdaction">
<p>
Donnez un nom à votre projet (pour nous: HelloWorld), et une
brève description si vous le souhaitez. Prenez une note mentale du
"Project path" (pour l'auteur de la capture d'écran il s'agit de
<code>https://git.esi-bru.be/nrichard</code>), puis pressez le bouton vert: Create
project.
</p>

</div>


<div class="figure">
<p><img src="./img/gitlab-NewProject-fields.jpg" alt="gitlab-NewProject-fields.jpg" />
</p>
</div>
</div>
</li>
<li><a id="org8d3e381"></a>Indiquez à Git l'emplacement du serveur: <code>git remote</code><br />
<div class="outline-text-5" id="text-2-4-2-3">
<div class="tdaction">
<p>
Dans Git Bash, tapotez ceci en modifiant l'URL là où c'est
nécessaire:
</p>

<pre class="example">
git remote add esi-gitlab https://git.esi-bru.be/nrichard/HelloWorld
</pre>

</div>

<div class="tdastuce">
<p>
Si vous avez mis la mauvaise URL, vous pouvez la modifier:
</p>

<pre class="example">
git remote set-url esi-gitlab https://cette-fois.il/faut/pas/se/planter
</pre>

</div>

<p>
Dans ce qui précède, <code>esi-gitlab</code> est désormais le nom de notre dépôt
distant ("remote" ou "remote repository" en anglais), c'est-à-dire un
dépôt Git différent du dépôt dans lequel vous vous trouvez
(<code>~/dev1/td-git/HelloWorld/</code>). Vous auriez pu choisir n'importe quel
autre nom.
</p>

<div class="tdaction">
<p>
Vérifiez avec <code>git remote -v</code> que l'URL est correcte.
</p>

</div>
</div>
</li>

<li><a id="org3a69139"></a>Déposez votre travail sur le dépôt distant.<br />
<div class="outline-text-5" id="text-2-4-2-4">
<p>
Nous allons indiquer à Git deux choses :
</p>

<ul class="org-ul">
<li>On veut utiliser <i>ce</i> dépôt distant <code>esi-gitlab</code> (pour pouvoir y
mettre notre travail)</li>
<li>On veut y mettre notre travail <i>maintenant</i></li>
</ul>

<p>
Attention: Pour cette étape vous aurez besoin du mot de passe défini
pour Gitlab. Si vous n'avez pas encore reçu le mail, allez voir le
dossier Spam. N'oubliez pas de vous déconnecter de Gitlab avant de
cliquer sur "Reset password" dans le mail. Votre nom d'utilisateur
</p>

<div class="tdaction">
<p>
Tapez:
</p>

<pre class="example">
git push -u esi-gitlab master
</pre>

</div>

<p>
Le paramètre <code>-u</code> indique à Git qu'il faudra encore utiliser ce dépôt
distant à l'avenir. Le mot <code>master</code> va rester mystérieux jusqu'à ce que
nous parlions de <a href="#orgcefb69a">branches</a>.
</p>
</div>
</li>

<li><a id="orgdd9de93"></a>Vérifiez que tout est en ligne<br />
<div class="outline-text-5" id="text-2-4-2-5">
<p>
Retournez sur le site Web Gitlab, rafraichissez la page et vérifiez que
vous retrouvez vos commits.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgd0ae3c1" class="outline-4">
<h4 id="orgd0ae3c1"><span class="section-number-4">2.4.3</span> linux1</h4>
<div class="outline-text-4" id="text-2-4-3">
</div>
<ol class="org-ol">
<li><a id="org6339029"></a>Connexion à linux1<br />
<div class="outline-text-5" id="text-2-4-3-1">
<div class="tdaction">
<p>
Avec PuTTY, connectez-vous à <code>linux1</code>.
</p>

</div>

<div class="tdaction">
<p>
Créez puis allez dans le répertoire <code>~/mesprojets/</code>.
</p>

</div>
</div>
</li>

<li><a id="orgb963427"></a>Créer un dépôt et récupérer le contenu du dépôt Gitlab<br />
<div class="outline-text-5" id="text-2-4-3-2">
<p>
Nous allons maintenant créer un dépôt sur <code>linux1</code> <i>et</i> y rapatrier le
code qui se trouve sur Gitlab, le tout en une seule étape facile.
</p>

<div class="tdaction">
<p>
Tapez <code>git clone https://git.esi-bru.be/nrichard/HelloWorld</code>
(Modifiez pour refléter votre propre dépôt Gitlab).
</p>

</div>

<div class="tdaction">
<p>
Allez voir le répertoire <code>HelloWorld</code> et vérifiez que tout y est
avec tout ce que vous connaissez:
</p>

<pre class="example">
cd HelloWorld
ls
git status
git remote -v
</pre>

</div>

<p>
Un dépôt distant a été automatiquement déclaré, et il s'appelle
<code>origin</code>.
</p>

<div class="tdaction">
<p>
Renommez le dépôt distant <code>origin</code>:
</p>

<pre class="example">
git remote rename origin esi-gitlab
</pre>

</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgb80ba9e" class="outline-4">
<h4 id="orgb80ba9e"><span class="section-number-4">2.4.4</span> Et ensuite&#x2026;</h4>
<div class="outline-text-4" id="text-2-4-4">
<p>
Nous avons utilisé <code>linux1</code> comme "autre machine". Vous pourriez
utiliser n'importe quelle autre machine à la place, par exemple la votre
à la maison, votre portable, une autre machine de l'école, etc.
</p>

<p>
Quelle que soit la machine, vous avez sans doute envie de pouvoir y
travailler, et puis de pouvoir récupérer ce travail sur votre machine de
départ.
</p>

<p>
Pour ce faire suivez la recette suivante :
</p>

<ul class="org-ul">
<li>Committez et tapez <code>git push</code> avant de quitter une machine.</li>
<li>Utilisez <code>git clone</code> quand vous utilisez une nouvelle machine (cela
crée un nouveau dépôt).</li>
<li>tapez <code>git pull</code> dans un dépôt pour le mettre à jour (c'est-à-dire quand vous utilisez une machine sur laquelle le
dépôt est déjà présent).</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb6a9a0c" class="outline-2">
<h2 id="orgb6a9a0c"><span class="section-number-2">3</span> Pour aller plus loin&#x2026;</h2>
<div class="outline-text-2" id="text-3">
<p>
La suite de ce document pourra vous être utile mais ne fait pas partie de la matière d'examen.
</p>
</div>
<div id="outline-container-orgcefb69a" class="outline-3">
<h3 id="orgcefb69a"><span class="section-number-3">3.1</span> Les branches</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org6b59faa" class="outline-4">
<h4 id="org6b59faa"><span class="section-number-4">3.1.1</span> Les principes</h4>
<div class="outline-text-4" id="text-3-1-1">
</div>
<ol class="org-ol">
<li><a id="orgb9babcf"></a>Notion de branche<br />
<div class="outline-text-5" id="text-3-1-1-1">
<p>
Jusqu'à présent vous avez
</p>

<ol class="org-ol">
<li>fait évoluer votre projet dans Git Bash, et</li>
<li>récupéré ce projet sur linux1 (via Gitlab)</li>
</ol>

<p>
Vous avez donc une copie de votre projet sur chaque machine, et vous
pourriez créer des commits sur l'une ou sur l'autre machine.
</p>


<div class="figure">
<p><img src="./img/branche-without-merge.png" alt="branche-without-merge.png" />
</p>
</div>

<p>
On parlera de <i>branches</i> : comme sur un arbre, depuis un tronc commun, plusieurs branches peuvent pousser dans des directions différentes.
</p>

<p>
Cependant, contrairement aux arbres, nous voudrons à un moment
réconcilier (fusionner) ces changements, et les branches vont alors se rejoindre :
</p>


<div class="figure">
<p><img src="./img/branche-with-merge.png" alt="branche-with-merge.png" />
</p>
</div>

<div class="tdaction">
<p>
Pour vous familiariser avec cette idée de branche, allez sur
<a href="https://learngitbranching.js.org/?NODEMO">Learn Git Branching</a> et
essayez les commandes suivantes tout en visualisant ce qui se passe dans
la fenêtre de droite. Notez la petite étoile * à côté du nom d'une des
branches.
</p>

<pre class="example">
git commit
git branch mabranche
git commit
git checkout mabranche
git commit
git checkout master
git merge mabranche
git commit
git merge mabranche
git checkout mabranche
git commit
git commit
git checkout master
git merge mabranche
git checkout mabranche
git merge master
</pre>

</div>

<p>
Ce que vous pouvez retirer de cette expérience :
</p>

<ul class="org-ul">
<li>Vous pouvez créer des branches avec <code>git branch nom-de-branche</code></li>
<li>Vous pouvez désigner une autre branche comme "branche courante" (= la
branche avec la petite étoile sur le site) avec
<code>git checkout nom-de-branche</code></li>
<li>Lorsque vous committez, c'est la branche courante qui grandit.</li>
<li>Vous pouvez fusionner une branche à la branche courante avec la commande
<code>git merge nom-de-branche</code> (dans ce cas c'est la branche courante
qui avance, mais <code>nom-de-branche</code> ne bouge pas).</li>
<li>Deux branches peuvent être confondues (c'est le cas de <code>mabranche</code> et
<code>master</code> à la fin de la procédure ci-dessus.)</li>
</ul>

<div class="tdastuce">
<p>
Pour en savoir plus sur la notion de branche, lisez l'annexe <a href="#org3e219ec">4.1</a>.
</p>

</div>
</div>
</li>
</ol>
</div>


<div id="outline-container-orgbe5146b" class="outline-4">
<h4 id="orgbe5146b"><span class="section-number-4">3.1.2</span> Modification du projet (linux1)</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
Revenant à notre projet, nous allons voir comment une modification et un
commit sur linux1 vont se concrétiser sous forme d'une nouvelle branche,
vu depuis Git Bash.
</p>
</div>

<ol class="org-ol">
<li><a id="orgf28a730"></a>Configurez Git<br />
<div class="outline-text-5" id="text-3-1-2-1">
<div class="tdaction">
<p>
Configurez Git sous linux1:
</p>

<pre class="example">
git config --global user.email "xxx@student.he2b.be"
git config --global user.name "Votre Nom"
</pre>

</div>
</div>
</li>

<li><a id="org04c52f4"></a>Ajoutez un test pour votre programme<br />
<div class="outline-text-5" id="text-3-1-2-2">
<div class="tdaction">
<p>
Créez le fichier <code>test.sh</code> dans <code>~/mesprojets/HelloWorld/</code> avec
le contenu suivant:
</p>

<pre class="example">
#!/bin/sh

compileProject () {
    mkdir -p build/
    javac -d build/ src/helloworld/HelloWorld.java
}
runProject () {
    java -cp build/ helloworld.HelloWorld
}

expected_output='Hello, World !'

compileProject
output=$(runProject)

if [ "$output" = "$expected_output" ]; then
    echo Test réussi.
else
    echo Test échoué.
    echo Sortie attendue: $expected_output
    echo Sortie obtenue: $output
fi
</pre>

</div>

<div class="tdaction">
<p>
Lancez le test avec <code>sh test.sh</code> et "Test réussi." doit s'afficher à la fin. Lorsque cela fonctionne, committez.
</p>

</div>
<div class="tdreponse">
<div class="verbatim">
<p>
git add test.sh
git commit -m "test.sh: nouveau fichier"
</p>

</div>

</div>
</div>
</li>

<li><a id="org65e1233"></a>Envoyez le résultat sur Gitlab (<code>git.esi-bru.be</code>)<br />
<div class="outline-text-5" id="text-3-1-2-3">
<p>
Pour envoyer sur Gitlab, on pourrait se demander s'il ne faut pas
d'abord ajouter Gitlab comme dépôt distant. Mais rappelez-vous de la
sortie de <code>git remote -v</code> juste après avoir exécuté <code>git clone</code>. Git l'a
ajouté pour vous !
</p>

<div class="tdaction">
<p>
Lancez
</p>

<pre class="example">
git push
</pre>

</div>

<p>
Optionellement vous pouviez ajouter le nom du dépôt distant. La commande
suivante fera donc la même chose que la précédente :
</p>

<pre class="example">
git push esi-gitlab
</pre>

<p>
Pour rappel : <code>esi-gitlab</code> est le nom que nous avions donné au dépôt
distant après l'avoir cloné. Par défaut c'était <code>origin</code>.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org6e2ebdc" class="outline-4">
<h4 id="org6e2ebdc"><span class="section-number-4">3.1.3</span> Modification du projet (Git Bash)</h4>
<div class="outline-text-4" id="text-3-1-3">
<div class="tdaction">
<p>
Modifiez, sous Netbeans, le texte qui suit <code>@author</code> pour y indiquer votre nom. Ensuite, committez ce changement (sous Git Bash).
</p>

</div>
</div>
</div>

<div id="outline-container-org354305a" class="outline-4">
<h4 id="org354305a"><span class="section-number-4">3.1.4</span> Récupération : linux1 vers Git Bash.</h4>
<div class="outline-text-4" id="text-3-1-4">
<div class="tdaction">
<p>
Pour récupérer le contenu de votre dépôt distant (remote) Gitlab, lancez
</p>

<pre class="example">
git remote update
</pre>

</div>

<p>
Cette commande a mis à jour la branche qui correspond au contenu de
Gitlab&#x2026; mais pas encore vos fichiers de travail. Pour cela il faudra
attendre la section <a href="#org824774d">diff et merge</a>.
</p>
</div>
</div>

<div id="outline-container-orgd79ca17" class="outline-4">
<h4 id="orgd79ca17"><span class="section-number-4">3.1.5</span> Voir les branches : <code>git branch</code></h4>
<div class="outline-text-4" id="text-3-1-5">
<div class="tdaction">
<p>
Tapez
</p>
<pre class="example">
git branch
</pre>

</div>

<p>
Vous constatez qu'il n'y a qu'une seule branche: <code>master</code>. En réalité il
y en a plus, mais elles sont cachées.
</p>

<div class="tdaction">
<p>
Tapez
</p>
<pre class="example">
git branch -a
</pre>

</div>

<p>
Vous constatez qu'il y a des branches distantes:
</p>

<pre class="example">
remotes/esi-gitlab/HEAD -&gt; esi-gitlab/master
remotes/esi-gitlab/master
</pre>

<p>
C'est là qu'est caché le travail que nous avions mis sur linux1
</p>
</div>
</div>
</div>

<div id="outline-container-org38fd6d4" class="outline-3">
<h3 id="org38fd6d4"><span class="section-number-3">3.2</span> Lecture de l'historique (variante arborescente)</h3>
<div class="outline-text-3" id="text-3-2">
<div class="tdaction">
<p>
Regardez l'historique de votre dépôt.
</p>

<pre class="example">
git log
</pre>

</div>

<p>
Aucune trace du commit réalisé sur <code>linux1</code>. C'est normal, il n'a pas
encore été fusionné à votre dépôt Git Bash.
</p>

<div class="tdaction">
<p>
Regardez l'historique de toutes les branches
</p>

<pre class="example">
git log --all
</pre>

</div>

<p>
Normalement vous retrouvez ici le commit créé sur linux1. Pour mieux
comprendre cet historique,nous allons demander à Git un petit dessin
(<code>--graph</code>). Nous lui demandons aussi de donner moins d'information sur
chaque commit afin que chacun tienne sur une ligne (<code>--oneline</code>).
</p>

<div class="tdaction">
<p>
Lancez:
</p>

<pre class="example">
git log --all --graph --oneline
</pre>

</div>

<p>
Vous constatez alors qu'il y a une bifurcation.
</p>

<p>
Alternativement, vous pouvez lancer:
</p>

<pre class="example">
gitk --all
</pre>

<p>
et voir le résultat dans <code>gitk</code>.
</p>
</div>
</div>

<div id="outline-container-org824774d" class="outline-3">
<h3 id="org824774d"><span class="section-number-3">3.3</span> diff et merge</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Nous avons deux branches qui ont divergé : <code>master</code> et
<code>esi-gitlab/master</code>.
</p>

<p>
Rappelons que <code>master</code> est la branche courante. Le répertoire de travail
contient donc normalement la même chose que cette branche (à l'exception
éventuelle des modifications répertoriées par <code>git status</code>).
</p>
</div>

<div id="outline-container-orgbedb1fc" class="outline-4">
<h4 id="orgbedb1fc"><span class="section-number-4">3.3.1</span> Comparaison : diff</h4>
<div class="outline-text-4" id="text-3-3-1">
<div class="tdaction">
<p>
Lancez la commande suivante et observez le résultat.
</p>
<pre class="example">
git diff master esi-gitlab/master
</pre>

</div>
</div>
</div>

<div id="outline-container-org58f9c47" class="outline-4">
<h4 id="org58f9c47"><span class="section-number-4">3.3.2</span> Fusion : merge</h4>
<div class="outline-text-4" id="text-3-3-2">
<div class="tdaction">
<p>
Lancez la commande
</p>
<pre class="example">
git merge esi-gitlab/master
</pre>

</div>

<p>
Le programme <code>vim</code> se lance en vous proposant de donner un message pour
décrire la fusion. Lorsque ce message vous agrée, vous pouvez simplement
sauver et quitter en tapant <code>:x</code>.
</p>

<div class="tdaction">
<p>
Tapez immédiatement <code>:x</code> pour utiliser le message proposé par
défaut.
</p>

</div>

<p>
Notez que Git réalise la fusion de façon entièrement automatisée quand
il estime qu'il peut le faire.
</p>

<p>
En quelques mots la procédure est la suivante :
</p>

<ul class="org-ul">
<li>Git détermine un commit qui est ancêtre commun aux deux branches (le
point de bifurcation des branches).</li>
<li>Git vérifie compare les modifications apportées par le bout de chaque
branches par rapport à cet ancêtre.</li>
<li>Si ces modifications ont l'air indépendantes (par exemple : les
fichiers modifiés ne sont pas les mêmes, ou alors les modifications
sont dans des endroits assez éloignés d'un même fichier), Git procède
à la fusion des changements.</li>
</ul>

<div class="tdastuce">
<p>
Vous pouvez modifier l'éditeur par défaut de diverses manière.
L'une d'elle consiste à modifier l'éditeur par défaut uniquement pour
git, par exemple pour utiliser Notepad++ :
</p>

<pre class="example">
git config --global core.editor
    "'C:/Program Files (x86)/Notepad++/notepad++.exe' 
    -multiInst -notabbar -nosession -noPlugin"
</pre>

<p>
(Pour la lisibilité, cette commande est sur plusieurs lignes mais il faut l'introduire en une seule ligne.)
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-orga427116" class="outline-3">
<h3 id="orga427116"><span class="section-number-3">3.4</span> Lecture de l'historique (variante DAG)</h3>
<div class="outline-text-3" id="text-3-4">
<div class="tdaction">
<p>
Lancez la commande suivante et observez le résultat.
</p>
<pre class="example">
gitk --all
</pre>

</div>
</div>
</div>

<div id="outline-container-orge6a0974" class="outline-3">
<h3 id="orge6a0974"><span class="section-number-3">3.5</span> Gestion des conflits de fusion</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Il peut arriver que survienne un conflit de fusion. C'est à dire que Git
estime ne pas pouvoir sereinement fusionner les modifications entre deux
branches.
</p>

<p>
Pour tester cela, créons un tel conflit en modifiant un texte de deux
façons différentes (dans des branches différentes).
</p>

<div class="tdaction">
<p>
Créez une nouvelle branche <code>remove-comments</code>
</p>

<pre class="example">
git branch remove-comments
git checkout remove-comments
</pre>

</div>

<div class="tdastuce">
<p>
Ces deux commandes sont équivalentes à l'unique commande
suivante : <code>git checkout -b remove-comments</code>. Lisez la decsription de
<code>-b</code> dans <code>git help checkout</code> pour vous en convaincre.
</p>

</div>

<div class="tdaction">
<p>
Dans Netbeans, enlevez le commentaire généré par Netbeans en
haut du fichier, puis committez cette modification avec le message
"Remove auto-generated comments".
</p>

</div>

<div class="tdaction">
<p>
Revenez à la branche <code>master</code>:
</p>

<pre class="example">
git checkout master
</pre>

</div>

<p>
Dans Netbeans, constatez que le commentaire en haut du fichier est
revenu. Si ce n'est pas le cas après cinq secondes d'attente, allez dans
le menu <i>Source</i> puis choisissez <i>Scan for external changes</i> (tout en
bas de ce menu).
</p>

<div class="tdaction">
<p>
Dans Netbeans, modifiez le commentaire en haut du fichier comme le voulez, puis committez.
</p>

</div>

<p>
Par exemple vous pourriez écrire ceci à la place :
</p>

<pre class="example">
/*
 * This work is licensed under the Creative Commons Attribution-ShareAlike 4.0
 * International License. To view a copy of this license, visit
 * http://creativecommons.org/licenses/by-sa/4.0/ or send a letter to Creative
 * Commons, PO Box 1866, Mountain View, CA 94042, USA.
 */
</pre>

<div class="tdaction">
<p>
<a href="#org58f9c47">Fusionnez</a> la branche <code>fix-comment</code>.
</p>

</div>

<p>
Le résultat doit être un message tel que celui-ci :
</p>

<pre class="example">
Auto-merging src/helloworld/HelloWorld.java
CONFLICT (content): Merge conflict in src/helloworld/HelloWorld.java
Automatic merge failed; fix conflicts and then commit the result.
</pre>

<p>
Décodons :
</p>

<ol class="org-ol">
<li>(Tentative de) fusion automatique.</li>
<li>Conflit détecté dans <code>&lt;nom de fichier&gt;</code>.</li>
<li>Fusion automatique a échoué : à vous de jouer.</li>
</ol>

<div class="tdaction">
<p>
Retournez dans Netbeans. Vous y trouverez des "marqueurs de conflit de fusion"
(merge conflict markers): , <code>=======</code> et
.
</p>

</div>

<p>
Voici à quoi pourrait ressembler le haut de votre fichier :
</p>

<pre class="example">
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
/*
 * This work is licensed under the Creative Commons Attribution-ShareAlike 4.0
 * International License. To view a copy of this license, visit
 * http://creativecommons.org/licenses/by-sa/4.0/ or send a letter to Creative
 * Commons, PO Box 1866, Mountain View, CA 94042, USA.
 */
=======
&gt;&gt;&gt;&gt;&gt;&gt;&gt; fix-comment
package helloworld;
</pre>

<p>
Décryptage :
</p>

<ol class="org-ol">
<li>HEAD est un nom donné par Git au "commit courant", quel qu'il soit.</li>
<li>Les trois marqueurs délimitent la zone de conflit (entre <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> et
<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>) et la divisent en deux zones (une avant les <code>=======</code>, et
une après) :</li>
<li>La zone du haut correspond aux changements introduits par la branche
où vous vous trouviez (dans le cas présent : <code>master</code>). Plus
précisément : les changements entre HEAD et l'ancêtre commun à HEAD
et à la branche fusionnée.</li>
<li>La zone du bas correspond aux changements introduits par la branche
fusionnée (dans le cas présent : <code>fix-comment</code>).</li>
<li>fix-comment est le nom de la branche fusionnée.</li>
</ol>

<p>
Pour résoudre le conflit, vous pouvez soit:
</p>

<ul class="org-ul">
<li>le faire à la main : modifiez la zone de conflit pour qu'elle
corresponde à ce que doit être votre code après fusion, puis enlevez
les marqueurs.</li>
<li>demander à un outil externe, tel que Netbeans, ce que nous allons
faire ici.</li>
</ul>

<div class="tdaction">
<p>
Dans le menu Team, choisissez "Resolve Conflicts".
</p>

</div>


<div class="figure">
<p><img src="./img/NetBeans-merge-conflict.jpg" alt="NetBeans-merge-conflict.jpg" />
</p>
</div>

<p>
La fenêtre principale se divise en trois :
</p>

<ul class="org-ul">
<li>la zone en haut à gauche est la version <code>HEAD</code> (c'est-à-dire
<code>master</code>),</li>
<li>la zone en haut à droite est la version <code>fix-comment</code>, et</li>
<li>la zone en bas est le produit de la fusion.</li>
</ul>

<div class="tdaction">
<p>
Cliquez sur Accept au dessus de la version de gauche, puis Ok en
bas à droite et sauvez le résultat.
</p>

</div>

<div class="tdaction">
<p>
Dans Git Bash, lancez <code>git status</code>
</p>

</div>

<pre class="example">
On branch master
All conflicts fixed but you are still merging.
  (use "git commit" to conclude merge)

nothing to commit, working directory clean
</pre>

<div class="tdaction">
<p>
Lancez <code>git commit -m "Fusion: ajoute une licence"</code> pour
terminer la fusion.
</p>

</div>

<div class="tdastuce">
<p>
Si vous ne spécifiez pas "-m", un éditeur (par défaut <code>vim</code>) se
lance pour que vous écriviez votre description. Celui-ci peut comporter
plusieurs lignes, et généralement on écrit d'abord un résumé d'une
ligne (idéalement moins de 80 caractères), puis une ligne vide, puis un message détaillé.
</p>

</div>
</div>
</div>

<div id="outline-container-orgbd33a1d" class="outline-3">
<h3 id="orgbd33a1d"><span class="section-number-3">3.6</span> git et NetBeans</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Comme vous l'avez noté dans le menu Team, Netbeans offre une certaine
dose d'intégration avec Git. À vous de découvrir ce que vous pouvez
faire depuis Netbeans.
</p>
</div>
</div>
</div>

<div id="outline-container-org7d4c8c4" class="outline-2">
<h2 id="org7d4c8c4"><span class="section-number-2">4</span> Annexe</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org3e219ec" class="outline-3">
<h3 id="org3e219ec"><span class="section-number-3">4.1</span> Notion de branche, version abstraite</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Techniquement, une branche est simplement un fichier dans
<code>.git/refs/heads/</code>.
</p>

<p>
Comme on l'a déjà dit, un dépôt Git est un magasin de commits. Ces
commits ont une structure de graphe dirigé : chaque commit pointe vers
son parent (ou <i>ses parents</i>, en cas de fusion). Dès lors à partir d'un
commit quelconque, on peut "remonter la filière" en suivant ce lien de
parenté. Toutefois, un dépôt Git contient souvent des commits "cachés",
qui ne sont plus référencés nulle part.
</p>

<p>
Exemple parallèle : dans une bibliothèque publique, il y a des milliers
de livres. Pour s'y retrouver les bibliothécaires tiennent une liste des
livres (c'est le catalogue de la bibliothèque, qui est d'ailleurs
généralement informatisé). Pour trouver un livre, on va voir la liste,
qui contient l'emplacement, et puis on peut physiquement récupérer le
livre. Si un livre n'est pas dans la liste, personne ne l'empruntera
jamais, même s'il est dans la bibliothèque : il est "caché" (ou "perdu"
selon votre niveau d'optimisme).
</p>

<p>
Dans un dépôt Git, c'est similaire et cependant différent.
</p>

<ul class="org-ul">
<li>C'est similaire en ce sens qu'il y a généralement des milliers de
commits, et que pour retrouver un commit il faut qu'il soit référencé
quelque part. Les références sont les branches : si un commit est sur
une branche, on le retrouvera. Sinon il est "caché".</li>
<li>C'est cependant différent parce qu'il ne faut pas autant de branches
que de commits. On retrouvera un commit s'il est le bout d'une
branche, ou s'il est le parent d'un bout de branche, ou s'il est le
parent d'un parent d'un bout de branche, et ainsi de suite.</li>
<li>(Une autre différence est liée au fait que nous parlons ici de
fichiers informatiques : il est en fait aisé de lister tous les
commits jamais référencés, et de chercher parmi ceux-là ceux qui ont
des propriétés qui nous intéressent. Voyez <code>git help fsck</code> et en
particulier les options <code>--dangling</code> et <code>--lost-found</code> pour des
détails techniques bien au delà du cadre du présent document.)</li>
</ul>
</div>
</div>
<div id="outline-container-org1becd75" class="outline-3">
<h3 id="org1becd75"><span class="section-number-3">4.2</span> Anatomie d'un commit</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Un commit n'est en réalité rien d'autre qu'un petit fichier texte. On
peut en inspecter le contenu avec <code>git cat-file</code>, par exemple :
</p>

<pre class="example">
git cat-file commit HEAD
</pre>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara">Voir <a href="https://www.oxfordlearnersdictionaries.com/definition/english/commit">https://www.oxfordlearnersdictionaries.com/definition/english/commit</a></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="date">Date: Année 2018-2019</p>
<p class="author">Author: Nicolas Richard <a href="mailto:nrichard@he2b.be">nrichard@he2b.be</a></p>
<p class="date">Created: 2018-09-11 Tue 10:08</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
